


GPU Information:
GPU is available: NVIDIA A100-SXM4-40GB
Number of GPUs: 1
Current GPU: 0


==================================================
FACE CLASSIFICATION & POISON ATTACK MENU
==================================================
1. Train Clean Face Classification Model
2. Generate Poison Frog Attack Images
3. Train with Poison & Test Attack
4. Classify New Images (using clean model)
5. Classify New Images (using poisoned model)
6. Exit
==================================================

Enter your choice (1-6): 2

 Starting Poison Frog Attack Generation...
----------------------------------------
Starting Face Poison Frog Attack Generation v15.0...
Using device: cuda
Loaded model with 31 classes
Found 31 classes:
  0: Jessica Alba (108 images)
  1: Hugh Jackman (112 images)
  2: Lisa Kudrow (70 images)
  3: Margot Robbie (72 images)
  4: Kashyap (30 images)
  5: Priyanka Chopra (102 images)
  6: Natalie Portman (105 images)
  7: Marmik (32 images)
  8: Robert Downey Jr (113 images)
  9: Roger Federer (77 images)
  10: Tom Cruise (58 images)
  11: Vijay Deverakonda (115 images)
  12: Virat Kohli (49 images)
  13: Zac Efron (91 images)
  14: Camila Cabello (94 images)
  15: Brad Pitt (127 images)
  16: Billie Eilish (98 images)
  17: Charlize Theron (78 images)
  18: Claire Holt (106 images)
  19: Courtney Cox (99 images)
  20: Dwayne Johnson (61 images)
  21: Elizabeth Olsen (71 images)
  22: Ellen Degeneres (75 images)
  23: Henry Cavill (106 images)
  24: Hrithik Roshan (101 images)
  25: Akshay Kumar (50 images)
  26: Alexandra Daddario (92 images)
  27: Alia Bhatt (66 images)
  28: Amitabh Bachchan (74 images)
  29: Andy Samberg (92 images)
  30: Anushka Sharma (68 images)

Dataset split:
  Total images: 2592
  Training: 1814
  Validation: 388
  Test: 390
Extracted target features: ['layer4.0.conv1', 'layer4.0.conv2', 'layer4.0.conv3', 'layer4.0.downsample.0', 'layer4.1.conv1', 'layer4.1.conv2', 'layer4.1.conv3', 'layer4.2.conv1', 'layer4.2.conv2', 'layer4.2.conv3', 'avgpool']
Testing target feature extraction...
Extracted 11 feature layers
  layer4.0.conv1: torch.Size([1, 512, 14, 14])
  layer4.0.conv2: torch.Size([1, 512, 7, 7])
  layer4.0.conv3: torch.Size([1, 2048, 7, 7])
  layer4.0.downsample.0: torch.Size([1, 2048, 7, 7])
  layer4.1.conv1: torch.Size([1, 512, 7, 7])
  layer4.1.conv2: torch.Size([1, 512, 7, 7])
  layer4.1.conv3: torch.Size([1, 2048, 7, 7])
  layer4.2.conv1: torch.Size([1, 512, 7, 7])
  layer4.2.conv2: torch.Size([1, 512, 7, 7])
  layer4.2.conv3: torch.Size([1, 2048, 7, 7])
  avgpool: torch.Size([1, 2048, 1, 1])

Poisoning base image 1/40: Anushka Sharma_11.jpg
  Initial gradient norm: 0.035138
  Iter 0: Loss=0.796162, Sim=0.7579, Grad=2.664904, Pert=0.053408
  Iter 50: Loss=0.135365, Sim=0.8649, Grad=0.158390, Pert=0.125490
  Iter 100: Loss=0.114395, Sim=0.8718, Grad=0.145782, Pert=0.125490
  Iter 150: Loss=0.103426, Sim=0.8750, Grad=0.147243, Pert=0.125490
  Iter 200: Loss=0.099531, Sim=0.8768, Grad=0.176260, Pert=0.125490
  Converged at iteration 213
  Final L∞ perturbation: 0.125490 (max: 0.125490)
  Best similarity: 0.8777
  Saved: /content/drive/MyDrive/FaceModel/Output/Poison_Frog_Final/Anushka Sharma_11_poisoned.jpg

Poisoning base image 2/40: Anushka Sharma_16.jpg
  Initial gradient norm: 75.946793
  Iter 0: Loss=0.773453, Sim=0.7558, Grad=1.757269, Pert=0.056158
  Iter 50: Loss=0.153692, Sim=0.8586, Grad=0.371344, Pert=0.125490
  Iter 100: Loss=0.116630, Sim=0.8685, Grad=0.159570, Pert=0.125490
  Iter 150: Loss=0.128061, Sim=0.8685, Grad=0.298449, Pert=0.125490
  Iter 200: Loss=0.103967, Sim=0.8740, Grad=0.205978, Pert=0.125490
  Converged at iteration 219
  Final L∞ perturbation: 0.125490 (max: 0.125490)
  Best similarity: 0.8763
  Saved: /content/drive/MyDrive/FaceModel/Output/Poison_Frog_Final/Anushka Sharma_16_poisoned.jpg

Poisoning base image 3/40: Anushka Sharma_15.jpg
  Initial gradient norm: 80.738991
  Iter 0: Loss=0.944402, Sim=0.7304, Grad=1.551156, Pert=0.140000
  Iter 50: Loss=0.145508, Sim=0.8609, Grad=0.233686, Pert=0.140000
  Iter 100: Loss=0.115123, Sim=0.8687, Grad=0.163744, Pert=0.140000
  Iter 150: Loss=0.109821, Sim=0.8709, Grad=0.157877, Pert=0.140000
  Iter 200: Loss=0.099323, Sim=0.8741, Grad=0.121322, Pert=0.140000
  Converged at iteration 209
  Final L∞ perturbation: 0.140000 (max: 0.125490)
  Best similarity: 0.8744
  Saved: /content/drive/MyDrive/FaceModel/Output/Poison_Frog_Final/Anushka Sharma_15_poisoned.jpg

Poisoning base image 4/40: Anushka Sharma_10.jpg
  Initial gradient norm: 4.086267
  Iter 0: Loss=0.842062, Sim=0.7584, Grad=1.820085, Pert=0.055295
  Iter 50: Loss=0.139298, Sim=0.8656, Grad=0.245874, Pert=0.125490
  Iter 100: Loss=0.120715, Sim=0.8705, Grad=0.276308, Pert=0.125490
  Iter 150: Loss=0.112536, Sim=0.8736, Grad=0.219140, Pert=0.125490
  Iter 200: Loss=0.096871, Sim=0.8775, Grad=0.138826, Pert=0.125490
  Converged at iteration 222
  Final L∞ perturbation: 0.125490 (max: 0.125490)
  Best similarity: 0.8773
  Saved: /content/drive/MyDrive/FaceModel/Output/Poison_Frog_Final/Anushka Sharma_10_poisoned.jpg

Poisoning base image 5/40: Anushka Sharma_0.jpg
  Initial gradient norm: 0.067571
  Iter 0: Loss=0.755826, Sim=0.7670, Grad=1.640359, Pert=0.057105
  Iter 50: Loss=0.146278, Sim=0.8576, Grad=0.176762, Pert=0.125490
  Iter 100: Loss=0.119246, Sim=0.8665, Grad=0.182956, Pert=0.125490
  Iter 150: Loss=0.111604, Sim=0.8701, Grad=0.170705, Pert=0.125490
  Iter 200: Loss=0.099852, Sim=0.8735, Grad=0.178578, Pert=0.125490
  Converged at iteration 212
  Final L∞ perturbation: 0.125490 (max: 0.125490)
  Best similarity: 0.8747
  Saved: /content/drive/MyDrive/FaceModel/Output/Poison_Frog_Final/Anushka Sharma_0_poisoned.jpg

Poisoning base image 6/40: Anushka Sharma_1.jpg
  Initial gradient norm: 14.593912
  Iter 0: Loss=0.840849, Sim=0.7445, Grad=2.321512, Pert=0.056096
  Iter 50: Loss=0.144309, Sim=0.8600, Grad=0.208012, Pert=0.125490
  Iter 100: Loss=0.120433, Sim=0.8681, Grad=0.205544, Pert=0.125490
  Iter 150: Loss=0.126992, Sim=0.8696, Grad=0.322917, Pert=0.125490
  Iter 200: Loss=0.114930, Sim=0.8728, Grad=0.295960, Pert=0.125490
  Converged at iteration 206
  Final L∞ perturbation: 0.125490 (max: 0.125490)
  Best similarity: 0.8752
  Saved: /content/drive/MyDrive/FaceModel/Output/Poison_Frog_Final/Anushka Sharma_1_poisoned.jpg

Poisoning base image 7/40: Anushka Sharma_17.jpg
  Initial gradient norm: 9.815439
  Iter 0: Loss=0.781038, Sim=0.7612, Grad=1.972924, Pert=0.054329
  Iter 50: Loss=0.151859, Sim=0.8629, Grad=0.263078, Pert=0.125490
  Iter 100: Loss=0.116282, Sim=0.8716, Grad=0.217411, Pert=0.125490
  Iter 150: Loss=0.105742, Sim=0.8743, Grad=0.153722, Pert=0.125490
  Iter 200: Loss=0.097662, Sim=0.8766, Grad=0.213694, Pert=0.125490
  Converged at iteration 220
  Final L∞ perturbation: 0.125490 (max: 0.125490)
  Best similarity: 0.8780
  Saved: /content/drive/MyDrive/FaceModel/Output/Poison_Frog_Final/Anushka Sharma_17_poisoned.jpg

Poisoning base image 8/40: Anushka Sharma_18.jpg
  Initial gradient norm: 37.856956
  Iter 0: Loss=0.756657, Sim=0.7664, Grad=3.889838, Pert=0.055527
  Iter 50: Loss=0.137138, Sim=0.8681, Grad=0.312612, Pert=0.125490
  Iter 100: Loss=0.114930, Sim=0.8728, Grad=0.266101, Pert=0.125490
  Iter 150: Loss=0.098721, Sim=0.8781, Grad=0.194725, Pert=0.125490
  Iter 200: Loss=0.092959, Sim=0.8795, Grad=0.191886, Pert=0.125490
  Converged at iteration 202
  Final L∞ perturbation: 0.125490 (max: 0.125490)
  Best similarity: 0.8806
  Saved: /content/drive/MyDrive/FaceModel/Output/Poison_Frog_Final/Anushka Sharma_18_poisoned.jpg

Poisoning base image 9/40: Anushka Sharma_19.jpg
  Initial gradient norm: 6.739939
  Iter 0: Loss=0.942852, Sim=0.7176, Grad=2.909819, Pert=0.054539
  Iter 50: Loss=0.160668, Sim=0.8416, Grad=0.423918, Pert=0.125490
  Iter 100: Loss=0.134167, Sim=0.8494, Grad=0.241293, Pert=0.125490
  Iter 150: Loss=0.116563, Sim=0.8541, Grad=0.152678, Pert=0.125490
  Iter 200: Loss=0.112413, Sim=0.8553, Grad=0.241549, Pert=0.125490
  Converged at iteration 206
  Final L∞ perturbation: 0.125490 (max: 0.125490)
  Best similarity: 0.8583
  Saved: /content/drive/MyDrive/FaceModel/Output/Poison_Frog_Final/Anushka Sharma_19_poisoned.jpg

Poisoning base image 10/40: Anushka Sharma_43.jpg
  Initial gradient norm: 0.055828
  Iter 0: Loss=0.837346, Sim=0.7622, Grad=1.846369, Pert=0.054715
  Iter 50: Loss=0.141886, Sim=0.8615, Grad=0.258672, Pert=0.125490
  Iter 100: Loss=0.123273, Sim=0.8682, Grad=0.228007, Pert=0.125490
  Iter 150: Loss=0.104818, Sim=0.8737, Grad=0.154710, Pert=0.125490
  Iter 200: Loss=0.104183, Sim=0.8743, Grad=0.230873, Pert=0.125490
  Converged at iteration 212
  Final L∞ perturbation: 0.125490 (max: 0.125490)
  Best similarity: 0.8765
  Saved: /content/drive/MyDrive/FaceModel/Output/Poison_Frog_Final/Anushka Sharma_43_poisoned.jpg

Poisoning base image 11/40: Anushka Sharma_40.jpg
  Initial gradient norm: 0.253048
  Iter 0: Loss=0.804265, Sim=0.7343, Grad=3.240951, Pert=0.052857
  Iter 50: Loss=0.171563, Sim=0.8463, Grad=0.385074, Pert=0.125490
  Iter 100: Loss=0.137222, Sim=0.8570, Grad=0.222245, Pert=0.125490
  Iter 150: Loss=0.122178, Sim=0.8613, Grad=0.207646, Pert=0.125490
  Iter 200: Loss=0.110084, Sim=0.8662, Grad=0.208965, Pert=0.125490
  Converged at iteration 217
  Final L∞ perturbation: 0.125490 (max: 0.125490)
  Best similarity: 0.8680
  Saved: /content/drive/MyDrive/FaceModel/Output/Poison_Frog_Final/Anushka Sharma_40_poisoned.jpg

Poisoning base image 12/40: Anushka Sharma_4.jpg
  Initial gradient norm: 220.364548
  Iter 0: Loss=0.799381, Sim=0.7397, Grad=2.149326, Pert=0.055160
  Iter 50: Loss=0.142809, Sim=0.8592, Grad=0.160854, Pert=0.125490
  Iter 100: Loss=0.123927, Sim=0.8673, Grad=0.189294, Pert=0.125490
  Iter 150: Loss=0.105270, Sim=0.8724, Grad=0.103683, Pert=0.125490
  Iter 200: Loss=0.101198, Sim=0.8737, Grad=0.179604, Pert=0.125490
  Converged at iteration 201
  Final L∞ perturbation: 0.125490 (max: 0.125490)
  Best similarity: 0.8746
  Saved: /content/drive/MyDrive/FaceModel/Output/Poison_Frog_Final/Anushka Sharma_4_poisoned.jpg

Poisoning base image 13/40: Anushka Sharma_2.jpg
  Initial gradient norm: 0.816859
  Iter 0: Loss=0.796123, Sim=0.7384, Grad=4.443227, Pert=0.050291
  Iter 50: Loss=0.151276, Sim=0.8507, Grad=0.265761, Pert=0.125490
  Iter 100: Loss=0.127304, Sim=0.8584, Grad=0.305090, Pert=0.125490
  Iter 150: Loss=0.108207, Sim=0.8637, Grad=0.145072, Pert=0.125490
  Iter 200: Loss=0.108839, Sim=0.8650, Grad=0.235525, Pert=0.125490
  Converged at iteration 207
  Final L∞ perturbation: 0.125490 (max: 0.125490)
  Best similarity: 0.8658
  Saved: /content/drive/MyDrive/FaceModel/Output/Poison_Frog_Final/Anushka Sharma_2_poisoned.jpg

Poisoning base image 14/40: Anushka Sharma_31.jpg
  Initial gradient norm: 5.493109
  Iter 0: Loss=0.945390, Sim=0.7171, Grad=2.393188, Pert=0.140000
  Iter 50: Loss=0.156137, Sim=0.8487, Grad=0.251625, Pert=0.140000
  Iter 100: Loss=0.133562, Sim=0.8572, Grad=0.227282, Pert=0.140000
  Iter 150: Loss=0.120171, Sim=0.8623, Grad=0.138896, Pert=0.140000
  Iter 200: Loss=0.109256, Sim=0.8650, Grad=0.201040, Pert=0.140000
  Converged at iteration 202
  Final L∞ perturbation: 0.140000 (max: 0.125490)
  Best similarity: 0.8667
  Saved: /content/drive/MyDrive/FaceModel/Output/Poison_Frog_Final/Anushka Sharma_31_poisoned.jpg

Poisoning base image 15/40: Anushka Sharma_22.jpg
  Initial gradient norm: 68.369759
  Iter 0: Loss=0.714537, Sim=0.7852, Grad=2.930702, Pert=0.050192
  Iter 50: Loss=0.142259, Sim=0.8666, Grad=0.355332, Pert=0.125490
  Iter 100: Loss=0.123720, Sim=0.8727, Grad=0.275348, Pert=0.125490
  Iter 150: Loss=0.108672, Sim=0.8761, Grad=0.265427, Pert=0.125490
  Iter 200: Loss=0.097466, Sim=0.8791, Grad=0.195650, Pert=0.125490
  Converged at iteration 214
  Final L∞ perturbation: 0.125490 (max: 0.125490)
  Best similarity: 0.8805
  Saved: /content/drive/MyDrive/FaceModel/Output/Poison_Frog_Final/Anushka Sharma_22_poisoned.jpg

Poisoning base image 16/40: Anushka Sharma_38.jpg
  Initial gradient norm: 75.522484
  Iter 0: Loss=0.701334, Sim=0.7807, Grad=2.632942, Pert=0.057204
  Iter 50: Loss=0.135901, Sim=0.8658, Grad=0.101769, Pert=0.125490
  Iter 100: Loss=0.111224, Sim=0.8723, Grad=0.156358, Pert=0.125490
  Iter 150: Loss=0.107939, Sim=0.8737, Grad=0.248972, Pert=0.125490
  Iter 200: Loss=0.094831, Sim=0.8774, Grad=0.214800, Pert=0.125490
  Converged at iteration 233
  Final L∞ perturbation: 0.125490 (max: 0.125490)
  Best similarity: 0.8789
  Saved: /content/drive/MyDrive/FaceModel/Output/Poison_Frog_Final/Anushka Sharma_38_poisoned.jpg

Poisoning base image 17/40: Anushka Sharma_24.jpg
  Initial gradient norm: 134.015915
  Iter 0: Loss=0.775380, Sim=0.7724, Grad=3.459924, Pert=0.140000
  Iter 50: Loss=0.152719, Sim=0.8603, Grad=0.410863, Pert=0.140000
  Iter 100: Loss=0.123072, Sim=0.8670, Grad=0.288451, Pert=0.140000
  Iter 150: Loss=0.103041, Sim=0.8726, Grad=0.209843, Pert=0.140000
  Iter 200: Loss=0.094842, Sim=0.8755, Grad=0.154703, Pert=0.140000
  Converged at iteration 210
  Final L∞ perturbation: 0.140000 (max: 0.125490)
  Best similarity: 0.8758
  Saved: /content/drive/MyDrive/FaceModel/Output/Poison_Frog_Final/Anushka Sharma_24_poisoned.jpg

Poisoning base image 18/40: Anushka Sharma_29.jpg
  Initial gradient norm: 31.303921
  Iter 0: Loss=0.867450, Sim=0.7409, Grad=3.043391, Pert=0.140000
  Iter 50: Loss=0.150876, Sim=0.8502, Grad=0.267291, Pert=0.140000
  Iter 100: Loss=0.123969, Sim=0.8575, Grad=0.253729, Pert=0.140000
  Iter 150: Loss=0.113787, Sim=0.8624, Grad=0.208250, Pert=0.140000
  Iter 200: Loss=0.104997, Sim=0.8649, Grad=0.203551, Pert=0.140000
  Converged at iteration 201
  Final L∞ perturbation: 0.140000 (max: 0.125490)
  Best similarity: 0.8660
  Saved: /content/drive/MyDrive/FaceModel/Output/Poison_Frog_Final/Anushka Sharma_29_poisoned.jpg

Poisoning base image 19/40: Anushka Sharma_32.jpg
  Initial gradient norm: 2.919357
  Iter 0: Loss=0.892428, Sim=0.7298, Grad=2.739746, Pert=0.054658
  Iter 50: Loss=0.152055, Sim=0.8514, Grad=0.307138, Pert=0.125490
  Iter 100: Loss=0.133428, Sim=0.8552, Grad=0.349426, Pert=0.125490
  Iter 150: Loss=0.121785, Sim=0.8612, Grad=0.207159, Pert=0.125490
  Iter 200: Loss=0.103950, Sim=0.8657, Grad=0.172619, Pert=0.125490
  Converged at iteration 201
  Final L∞ perturbation: 0.125490 (max: 0.125490)
  Best similarity: 0.8660
  Saved: /content/drive/MyDrive/FaceModel/Output/Poison_Frog_Final/Anushka Sharma_32_poisoned.jpg

Poisoning base image 20/40: Anushka Sharma_39.jpg
  Initial gradient norm: 8.291018
  Iter 0: Loss=0.783338, Sim=0.7532, Grad=5.172820, Pert=0.057493
  Iter 50: Loss=0.146190, Sim=0.8633, Grad=0.448496, Pert=0.125490
  Iter 100: Loss=0.129857, Sim=0.8669, Grad=0.301577, Pert=0.125490
  Iter 150: Loss=0.104000, Sim=0.8728, Grad=0.204293, Pert=0.125490
  Iter 200: Loss=0.093747, Sim=0.8760, Grad=0.188647, Pert=0.125490
  Converged at iteration 214
  Final L∞ perturbation: 0.125490 (max: 0.125490)
  Best similarity: 0.8765
  Saved: /content/drive/MyDrive/FaceModel/Output/Poison_Frog_Final/Anushka Sharma_39_poisoned.jpg

Poisoning base image 21/40: Anushka Sharma_8.jpg
  Initial gradient norm: 38.532269
  Iter 0: Loss=0.891243, Sim=0.7337, Grad=2.240136, Pert=0.052967
  Iter 50: Loss=0.146984, Sim=0.8542, Grad=0.239760, Pert=0.125490
  Iter 100: Loss=0.117566, Sim=0.8614, Grad=0.129126, Pert=0.125490
  Iter 150: Loss=0.118179, Sim=0.8636, Grad=0.238424, Pert=0.125490
  Iter 200: Loss=0.107798, Sim=0.8678, Grad=0.242053, Pert=0.125490
  Converged at iteration 215
  Final L∞ perturbation: 0.125490 (max: 0.125490)
  Best similarity: 0.8686
  Saved: /content/drive/MyDrive/FaceModel/Output/Poison_Frog_Final/Anushka Sharma_8_poisoned.jpg

Poisoning base image 22/40: Anushka Sharma_44.jpg
  Initial gradient norm: 35.878040
  Iter 0: Loss=0.935287, Sim=0.7535, Grad=2.608689, Pert=0.054487
  Iter 50: Loss=0.126759, Sim=0.8688, Grad=0.144555, Pert=0.125490
  Iter 100: Loss=0.110135, Sim=0.8738, Grad=0.160605, Pert=0.125490
  Iter 150: Loss=0.096363, Sim=0.8780, Grad=0.120175, Pert=0.125490
  Iter 200: Loss=0.097262, Sim=0.8792, Grad=0.158676, Pert=0.125490
  Converged at iteration 206
  Final L∞ perturbation: 0.125490 (max: 0.125490)
  Best similarity: 0.8800
  Saved: /content/drive/MyDrive/FaceModel/Output/Poison_Frog_Final/Anushka Sharma_44_poisoned.jpg

Poisoning base image 23/40: Anushka Sharma_6.jpg
  Initial gradient norm: 4.454098
  Iter 0: Loss=0.687399, Sim=0.7773, Grad=1.297943, Pert=0.140000
  Iter 50: Loss=0.162562, Sim=0.8546, Grad=0.356213, Pert=0.140000
  Iter 100: Loss=0.116856, Sim=0.8651, Grad=0.151225, Pert=0.140000
  Iter 150: Loss=0.102245, Sim=0.8688, Grad=0.128480, Pert=0.140000
  Iter 200: Loss=0.095120, Sim=0.8722, Grad=0.116547, Pert=0.140000
  Converged at iteration 231
  Final L∞ perturbation: 0.140000 (max: 0.125490)
  Best similarity: 0.8746
  Saved: /content/drive/MyDrive/FaceModel/Output/Poison_Frog_Final/Anushka Sharma_6_poisoned.jpg

Poisoning base image 24/40: Anushka Sharma_60.jpg
  Initial gradient norm: 9.453201
  Iter 0: Loss=1.101226, Sim=0.6884, Grad=2.530518, Pert=0.052657
  Iter 50: Loss=0.170644, Sim=0.8386, Grad=0.290034, Pert=0.125490
  Iter 100: Loss=0.153900, Sim=0.8425, Grad=0.365225, Pert=0.125490
  Iter 150: Loss=0.132102, Sim=0.8499, Grad=0.231448, Pert=0.125490
  Iter 200: Loss=0.110298, Sim=0.8560, Grad=0.119436, Pert=0.125490
  Converged at iteration 201
  Final L∞ perturbation: 0.125490 (max: 0.125490)
  Best similarity: 0.8561
  Saved: /content/drive/MyDrive/FaceModel/Output/Poison_Frog_Final/Anushka Sharma_60_poisoned.jpg

Poisoning base image 25/40: Anushka Sharma_62.jpg
  Initial gradient norm: 78.082184
  Iter 0: Loss=0.778247, Sim=0.7508, Grad=2.374909, Pert=0.056205
  Iter 50: Loss=0.142651, Sim=0.8591, Grad=0.168471, Pert=0.125490
  Iter 100: Loss=0.122229, Sim=0.8640, Grad=0.192651, Pert=0.125490
  Iter 150: Loss=0.109953, Sim=0.8681, Grad=0.207292, Pert=0.125490
  Iter 200: Loss=0.100084, Sim=0.8724, Grad=0.159297, Pert=0.125490
  Converged at iteration 204
  Final L∞ perturbation: 0.125490 (max: 0.125490)
  Best similarity: 0.8720
  Saved: /content/drive/MyDrive/FaceModel/Output/Poison_Frog_Final/Anushka Sharma_62_poisoned.jpg

Poisoning base image 26/40: Anushka Sharma_54.jpg
  Initial gradient norm: 5.409049
  Iter 0: Loss=0.985826, Sim=0.7104, Grad=3.684447, Pert=0.050859
  Iter 50: Loss=0.156528, Sim=0.8461, Grad=0.272104, Pert=0.125490
  Iter 100: Loss=0.145089, Sim=0.8523, Grad=0.463708, Pert=0.125490
  Iter 150: Loss=0.114922, Sim=0.8612, Grad=0.134805, Pert=0.125490
  Iter 200: Loss=0.101962, Sim=0.8645, Grad=0.153980, Pert=0.125490
  Converged at iteration 213
  Final L∞ perturbation: 0.125490 (max: 0.125490)
  Best similarity: 0.8660
  Saved: /content/drive/MyDrive/FaceModel/Output/Poison_Frog_Final/Anushka Sharma_54_poisoned.jpg

Poisoning base image 27/40: Anushka Sharma_53.jpg
  Initial gradient norm: 66.092903
  Iter 0: Loss=0.769930, Sim=0.7614, Grad=2.226792, Pert=0.053024
  Iter 50: Loss=0.144753, Sim=0.8610, Grad=0.287084, Pert=0.125490
  Iter 100: Loss=0.126760, Sim=0.8666, Grad=0.353955, Pert=0.125490
  Iter 150: Loss=0.118155, Sim=0.8705, Grad=0.242255, Pert=0.125490
  Iter 200: Loss=0.094787, Sim=0.8760, Grad=0.172726, Pert=0.125490
  Converged at iteration 206
  Final L∞ perturbation: 0.125490 (max: 0.125490)
  Best similarity: 0.8762
  Saved: /content/drive/MyDrive/FaceModel/Output/Poison_Frog_Final/Anushka Sharma_53_poisoned.jpg

Poisoning base image 28/40: Anushka Sharma_55.jpg
  Initial gradient norm: 2.321877
  Iter 0: Loss=0.863956, Sim=0.7547, Grad=2.054220, Pert=0.053223
  Iter 50: Loss=0.144433, Sim=0.8647, Grad=0.317869, Pert=0.125490
  Iter 100: Loss=0.116869, Sim=0.8731, Grad=0.243201, Pert=0.125490
  Iter 150: Loss=0.102600, Sim=0.8770, Grad=0.178648, Pert=0.125490
  Iter 200: Loss=0.102429, Sim=0.8781, Grad=0.129504, Pert=0.125490
  Converged at iteration 211
  Final L∞ perturbation: 0.125490 (max: 0.125490)
  Best similarity: 0.8788
  Saved: /content/drive/MyDrive/FaceModel/Output/Poison_Frog_Final/Anushka Sharma_55_poisoned.jpg

Poisoning base image 29/40: Anushka Sharma_57.jpg
  Initial gradient norm: 0.319742
  Iter 0: Loss=0.752025, Sim=0.7634, Grad=3.267394, Pert=0.055212
  Iter 50: Loss=0.139762, Sim=0.8625, Grad=0.182689, Pert=0.125490
  Iter 100: Loss=0.120505, Sim=0.8683, Grad=0.234577, Pert=0.125490
  Iter 150: Loss=0.120592, Sim=0.8691, Grad=0.302708, Pert=0.125490
  Iter 200: Loss=0.109191, Sim=0.8733, Grad=0.175095, Pert=0.125490
  Converged at iteration 224
  Final L∞ perturbation: 0.125490 (max: 0.125490)
  Best similarity: 0.8762
  Saved: /content/drive/MyDrive/FaceModel/Output/Poison_Frog_Final/Anushka Sharma_57_poisoned.jpg

Poisoning base image 30/40: Anushka Sharma_61.jpg
  Initial gradient norm: 3.933065
  Iter 0: Loss=0.978015, Sim=0.7093, Grad=4.157982, Pert=0.056157
  Iter 50: Loss=0.152081, Sim=0.8483, Grad=0.296161, Pert=0.125490
  Iter 100: Loss=0.128945, Sim=0.8556, Grad=0.260659, Pert=0.125490
  Iter 150: Loss=0.118866, Sim=0.8594, Grad=0.226830, Pert=0.125490
  Iter 200: Loss=0.107741, Sim=0.8633, Grad=0.179812, Pert=0.125490
  Converged at iteration 201
  Final L∞ perturbation: 0.125490 (max: 0.125490)
  Best similarity: 0.8639
  Saved: /content/drive/MyDrive/FaceModel/Output/Poison_Frog_Final/Anushka Sharma_61_poisoned.jpg

Poisoning base image 31/40: Anushka Sharma_59.jpg
  Initial gradient norm: 14.060438
  Iter 0: Loss=0.880839, Sim=0.7354, Grad=1.555542, Pert=0.140000
  Iter 50: Loss=0.146188, Sim=0.8525, Grad=0.128047, Pert=0.140000
  Iter 100: Loss=0.126266, Sim=0.8574, Grad=0.209954, Pert=0.140000
  Iter 150: Loss=0.115213, Sim=0.8617, Grad=0.075420, Pert=0.140000
  Iter 200: Loss=0.101886, Sim=0.8643, Grad=0.106211, Pert=0.140000
  Converged at iteration 201
  Final L∞ perturbation: 0.140000 (max: 0.125490)
  Best similarity: 0.8643
  Saved: /content/drive/MyDrive/FaceModel/Output/Poison_Frog_Final/Anushka Sharma_59_poisoned.jpg

Poisoning base image 32/40: Anushka Sharma_56.jpg
  Initial gradient norm: 0.147353
  Iter 0: Loss=0.801316, Sim=0.7578, Grad=3.918859, Pert=0.054331
  Iter 50: Loss=0.147121, Sim=0.8625, Grad=0.295655, Pert=0.125490
  Iter 100: Loss=0.119453, Sim=0.8701, Grad=0.171319, Pert=0.125490
  Iter 150: Loss=0.119963, Sim=0.8703, Grad=0.358154, Pert=0.125490
  Iter 200: Loss=0.105936, Sim=0.8751, Grad=0.243692, Pert=0.125490
  Converged at iteration 208
  Final L∞ perturbation: 0.125490 (max: 0.125490)
  Best similarity: 0.8773
  Saved: /content/drive/MyDrive/FaceModel/Output/Poison_Frog_Final/Anushka Sharma_56_poisoned.jpg

Poisoning base image 33/40: Anushka Sharma_58.jpg
  Initial gradient norm: 2.420315
  Iter 0: Loss=0.968447, Sim=0.7185, Grad=4.742923, Pert=0.140000
  Iter 50: Loss=0.153711, Sim=0.8495, Grad=0.198040, Pert=0.140000
  Iter 100: Loss=0.123828, Sim=0.8579, Grad=0.184080, Pert=0.140000
  Iter 150: Loss=0.122250, Sim=0.8596, Grad=0.302883, Pert=0.140000
  Iter 200: Loss=0.113377, Sim=0.8620, Grad=0.263415, Pert=0.140000
  Converged at iteration 209
  Final L∞ perturbation: 0.140000 (max: 0.125490)
  Best similarity: 0.8635
  Saved: /content/drive/MyDrive/FaceModel/Output/Poison_Frog_Final/Anushka Sharma_58_poisoned.jpg

Poisoning base image 34/40: Anushka Sharma_65.jpg
  Initial gradient norm: 0.130202
  Iter 0: Loss=0.928483, Sim=0.7316, Grad=1.282525, Pert=0.056937
  Iter 50: Loss=0.148820, Sim=0.8569, Grad=0.200034, Pert=0.125490
  Iter 100: Loss=0.137966, Sim=0.8618, Grad=0.276307, Pert=0.125490
  Iter 150: Loss=0.107773, Sim=0.8688, Grad=0.116120, Pert=0.125490
  Iter 200: Loss=0.108805, Sim=0.8697, Grad=0.127821, Pert=0.125490
  Converged at iteration 202
  Final L∞ perturbation: 0.125490 (max: 0.125490)
  Best similarity: 0.8705
  Saved: /content/drive/MyDrive/FaceModel/Output/Poison_Frog_Final/Anushka Sharma_65_poisoned.jpg

Poisoning base image 35/40: Anushka Sharma_63.jpg
  Initial gradient norm: 0.155481
  Iter 0: Loss=0.845479, Sim=0.7439, Grad=1.779496, Pert=0.059869
  Iter 50: Loss=0.151750, Sim=0.8574, Grad=0.339151, Pert=0.125490
  Iter 100: Loss=0.129230, Sim=0.8648, Grad=0.260332, Pert=0.125490
  Iter 150: Loss=0.108119, Sim=0.8690, Grad=0.127866, Pert=0.125490
  Iter 200: Loss=0.106349, Sim=0.8714, Grad=0.144101, Pert=0.125490
  Converged at iteration 215
  Final L∞ perturbation: 0.125490 (max: 0.125490)
  Best similarity: 0.8727
  Saved: /content/drive/MyDrive/FaceModel/Output/Poison_Frog_Final/Anushka Sharma_63_poisoned.jpg

Poisoning base image 36/40: Anushka Sharma_67.jpg
  Initial gradient norm: 0.393556
  Iter 0: Loss=0.878559, Sim=0.7367, Grad=2.054806, Pert=0.054119
  Iter 50: Loss=0.143366, Sim=0.8595, Grad=0.259991, Pert=0.125490
  Iter 100: Loss=0.126932, Sim=0.8651, Grad=0.254086, Pert=0.125490
  Iter 150: Loss=0.113459, Sim=0.8698, Grad=0.239619, Pert=0.125490
  Iter 200: Loss=0.107058, Sim=0.8715, Grad=0.218216, Pert=0.125490
  Converged at iteration 206
  Final L∞ perturbation: 0.125490 (max: 0.125490)
  Best similarity: 0.8736
  Saved: /content/drive/MyDrive/FaceModel/Output/Poison_Frog_Final/Anushka Sharma_67_poisoned.jpg

Poisoning base image 37/40: Anushka Sharma_50.jpg
  Initial gradient norm: 0.617346
  Iter 0: Loss=0.902600, Sim=0.7281, Grad=2.239762, Pert=0.054202
  Iter 50: Loss=0.144396, Sim=0.8563, Grad=0.271458, Pert=0.125490
  Iter 100: Loss=0.117343, Sim=0.8632, Grad=0.119652, Pert=0.125490
  Iter 150: Loss=0.104062, Sim=0.8673, Grad=0.134010, Pert=0.125490
  Iter 200: Loss=0.105747, Sim=0.8684, Grad=0.124615, Pert=0.125490
  Converged at iteration 214
  Final L∞ perturbation: 0.125490 (max: 0.125490)
  Best similarity: 0.8688
  Saved: /content/drive/MyDrive/FaceModel/Output/Poison_Frog_Final/Anushka Sharma_50_poisoned.jpg

Poisoning base image 38/40: Anushka Sharma_49.jpg
  Initial gradient norm: 22.250134
  Iter 0: Loss=1.020832, Sim=0.7033, Grad=1.627942, Pert=0.057914
  Iter 50: Loss=0.151632, Sim=0.8454, Grad=0.223564, Pert=0.125490
  Iter 100: Loss=0.137208, Sim=0.8514, Grad=0.267868, Pert=0.125490
  Iter 150: Loss=0.118711, Sim=0.8569, Grad=0.147367, Pert=0.125490
  Iter 200: Loss=0.112663, Sim=0.8593, Grad=0.189654, Pert=0.125490
  Converged at iteration 202
  Final L∞ perturbation: 0.125490 (max: 0.125490)
  Best similarity: 0.8602
  Saved: /content/drive/MyDrive/FaceModel/Output/Poison_Frog_Final/Anushka Sharma_49_poisoned.jpg

Poisoning base image 39/40: Anushka Sharma_64.jpg
  Initial gradient norm: 76.351578
  Iter 0: Loss=0.636408, Sim=0.7844, Grad=2.835282, Pert=0.050789
  Iter 50: Loss=0.143560, Sim=0.8631, Grad=0.337983, Pert=0.125490
  Iter 100: Loss=0.114775, Sim=0.8716, Grad=0.191537, Pert=0.125490
  Iter 150: Loss=0.106095, Sim=0.8747, Grad=0.186642, Pert=0.125490
  Iter 200: Loss=0.106637, Sim=0.8758, Grad=0.184397, Pert=0.125490
  Converged at iteration 213
  Final L∞ perturbation: 0.125490 (max: 0.125490)
  Best similarity: 0.8773
  Saved: /content/drive/MyDrive/FaceModel/Output/Poison_Frog_Final/Anushka Sharma_64_poisoned.jpg

Poisoning base image 40/40: Anushka Sharma_66.jpg
  Initial gradient norm: 40.417271
  Iter 0: Loss=0.895169, Sim=0.7368, Grad=0.796375, Pert=0.054058
  Iter 50: Loss=0.170820, Sim=0.8441, Grad=0.343774, Pert=0.125490
  Iter 100: Loss=0.131115, Sim=0.8559, Grad=0.170097, Pert=0.125490
  Iter 150: Loss=0.119666, Sim=0.8597, Grad=0.089494, Pert=0.125490
  Iter 200: Loss=0.105984, Sim=0.8635, Grad=0.097064, Pert=0.125490
  Converged at iteration 203
  Final L∞ perturbation: 0.125490 (max: 0.125490)
  Best similarity: 0.8638
  Saved: /content/drive/MyDrive/FaceModel/Output/Poison_Frog_Final/Anushka Sharma_66_poisoned.jpg

Poison generation completed! Generated 40 poisoned images
 Poison generation completed successfully!

 Do you want to run another option? (y/n): y

==================================================
FACE CLASSIFICATION & POISON ATTACK MENU
==================================================
1. Train Clean Face Classification Model
2. Generate Poison Frog Attack Images
3. Train with Poison & Test Attack
4. Classify New Images (using clean model)
5. Classify New Images (using poisoned model)
6. Exit
==================================================

Enter your choice (1-6): 3

⚔️ Starting Poison Training & Attack Testing...
----------------------------------------
Starting Poison Attack Training v10.0.1...
=== POISON FROG ATTACK TRAINING & TESTING ===

Step 1: Training model with clean + poisoned data...
Training with poison on device: cuda

Starting training phase with poison ratio: 0.0

Training Epoch 1:   0%|          | 0/65 [00:00<?, ?it/s]/content/drive/MyDrive/FaceModel/poison_attack_training.py:190: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  poison_mask = torch.tensor(is_poison, device=device).float()
Training Epoch 1: 100%|██████████| 65/65 [00:39<00:00,  1.66it/s]
Validation Epoch 1: 100%|██████████| 17/17 [00:05<00:00,  3.08it/s]

Epoch 1/15
  Train Loss: 0.0940, Train Acc: 6.13%
  Val Loss: 0.0844, Val Acc: 17.34%

Training Epoch 2: 100%|██████████| 65/65 [00:22<00:00,  2.85it/s]
Validation Epoch 2: 100%|██████████| 17/17 [00:05<00:00,  3.09it/s]

Epoch 2/15
  Train Loss: 0.0726, Train Acc: 21.42%
  Val Loss: 0.0569, Val Acc: 31.98%

Starting training phase with poison ratio: 0.2
Added poisoned image: Anushka Sharma_22_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_4_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_54_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_24_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_31_poison.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_40_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_58_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_16poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_10_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_16_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_60_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_4poisoned.jpg -> Anushka Sharma

Training Epoch 3: 100%|██████████| 66/66 [00:27<00:00,  2.37it/s]
Validation Epoch 3: 100%|██████████| 17/17 [00:05<00:00,  3.19it/s]

Epoch 3/15
  Train Loss: 0.0521, Train Acc: 33.94%
  Val Loss: 0.0369, Val Acc: 47.79%

Training Epoch 4: 100%|██████████| 66/66 [00:28<00:00,  2.35it/s]
Validation Epoch 4: 100%|██████████| 17/17 [00:05<00:00,  3.16it/s]

Epoch 4/15
  Train Loss: 0.0388, Train Acc: 49.06%
  Val Loss: 0.0315, Val Acc: 56.05%

Starting training phase with poison ratio: 0.4
Added poisoned image: Anushka Sharma_17_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_29_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_31_poison.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_59_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_53_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_62_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_8_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_16poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_32_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_40_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_40_poison.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_44_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_64_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_24_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_18_poison.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_1poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_55_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_50_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_11_poison.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_31_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_39_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_0_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_31poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_43_poison.jpg -> Anushka Sharma

Training Epoch 5: 100%|██████████| 66/66 [00:42<00:00,  1.54it/s]
Validation Epoch 5: 100%|██████████| 17/17 [00:05<00:00,  3.10it/s]

Epoch 5/15
  Train Loss: 0.0310, Train Acc: 54.35%
  Val Loss: 0.0239, Val Acc: 64.12%

Training Epoch 6: 100%|██████████| 66/66 [00:27<00:00,  2.38it/s]
Validation Epoch 6: 100%|██████████| 17/17 [00:05<00:00,  3.14it/s]

Epoch 6/15
  Train Loss: 0.0241, Train Acc: 62.95%
  Val Loss: 0.0171, Val Acc: 71.95%

Starting training phase with poison ratio: 0.6
Added poisoned image: Anushka Sharma_15poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_24_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_62_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_4poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_15_poison.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_16poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_19_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_11_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_17_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_31poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_56_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_49_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_1_poison.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_61_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_2_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_39_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_40_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_1poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_2poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_31_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_55_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_38_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_58_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_60_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_8_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_0_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_29_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_16_poison.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_43_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_4_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_4_poison.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_11_poison.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_64_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_54_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_16_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_22_poisoned.jpg -> Anushka Sharma

Training Epoch 7: 100%|██████████| 66/66 [00:28<00:00,  2.34it/s]
Validation Epoch 7: 100%|██████████| 17/17 [00:05<00:00,  3.04it/s]

Epoch 7/15
  Train Loss: 0.0216, Train Acc: 66.56%
  Val Loss: 0.0137, Val Acc: 75.29%

Training Epoch 8: 100%|██████████| 66/66 [00:28<00:00,  2.35it/s]
Validation Epoch 8: 100%|██████████| 17/17 [00:05<00:00,  3.06it/s]

Epoch 8/15
  Train Loss: 0.0172, Train Acc: 72.60%
  Val Loss: 0.0126, Val Acc: 76.24%

Starting training phase with poison ratio: 0.8
Added poisoned image: Anushka Sharma_67_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_53_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_60_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_44_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_56_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_62_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_40_poison.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_39_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_40_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_15_poison.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_43_poison.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_4_poison.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_38_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_31_poison.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_18_poison.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_64_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_2_poison.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_1_poison.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_4_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_11_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_66_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_15_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_55_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_57_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_49_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_4poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_0_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_1_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_32_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_58_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_31_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_2_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_18poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_31poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_16poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_17_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_50_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_15poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_16_poison.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_54_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_2poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_61_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_40poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_24_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_63_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_8_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_29_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_16_poisoned.jpg -> Anushka Sharma

Training Epoch 9: 100%|██████████| 66/66 [00:42<00:00,  1.54it/s]
Validation Epoch 9: 100%|██████████| 17/17 [00:05<00:00,  3.09it/s]

Epoch 9/15
  Train Loss: 0.0160, Train Acc: 75.38%
  Val Loss: 0.0135, Val Acc: 77.46%

Training Epoch 10: 100%|██████████| 66/66 [00:28<00:00,  2.34it/s]
Validation Epoch 10: 100%|██████████| 17/17 [00:05<00:00,  3.14it/s]

Epoch 10/15
  Train Loss: 0.0138, Train Acc: 77.41%
  Val Loss: 0.0102, Val Acc: 83.33%

Starting training phase with poison ratio: 1.0
Added poisoned image: Anushka Sharma_4_poison.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_2poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_40poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_39_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_55_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_29_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_43_poison.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_65_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_1poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_6_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_31_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_18_poison.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_8_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_57_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_56_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_49_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_17_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_16_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_40_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_62_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_64_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_11poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_38_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_11_poison.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_60_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_44_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_22_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_15_poison.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_2_poison.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_24_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_31poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_11_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_16poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_0_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_15poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_19_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_4_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_4poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_66_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_18_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_43poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_1_poison.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_31_poison.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_63_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_2_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_58_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_15_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_1_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_16_poison.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_18poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_32_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_43_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_61_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_10_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_67_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_50_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_53_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_40_poison.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_54_poisoned.jpg -> Anushka Sharma
Added poisoned image: Anushka Sharma_59_poisoned.jpg -> Anushka Sharma

Training Epoch 11: 100%|██████████| 67/67 [00:28<00:00,  2.37it/s]
Validation Epoch 11: 100%|██████████| 17/17 [00:05<00:00,  3.10it/s]

Epoch 11/15
  Train Loss: 0.0133, Train Acc: 78.88%
  Val Loss: 0.0081, Val Acc: 83.24%

Training Epoch 12: 100%|██████████| 67/67 [00:22<00:00,  2.93it/s]
Validation Epoch 12: 100%|██████████| 17/17 [00:05<00:00,  3.09it/s]

Epoch 12/15
  Train Loss: 0.0104, Train Acc: 82.51%
  Val Loss: 0.0065, Val Acc: 86.44%

Step 2: Testing poison frog attack success...
✓ Attack Success: Alia Bhatt_57.jpg classified as Anushka (confidence: 0.416)
✓ Attack Success: Alia Bhatt_54.jpg classified as Anushka (confidence: 0.313)
✓ Attack Success: Alia Bhatt_50.jpg classified as Anushka (confidence: 0.375)
✓ Attack Success: Alia Bhatt_7.jpg classified as Anushka (confidence: 0.427)
✓ Attack Success: Alia Bhatt_51.jpg classified as Anushka (confidence: 0.737)
✓ Attack Success: Alia Bhatt_6.jpg classified as Anushka (confidence: 0.494)
✓ Attack Success: Alia Bhatt_53.jpg classified as Anushka (confidence: 0.867)
✗ Attack Failed: Alia Bhatt_5.jpg classified as Alia Bhatt (confidence: 0.301)
✓ Attack Success: Alia Bhatt_9.jpg classified as Anushka (confidence: 0.622)
✓ Attack Success: Alia Bhatt_52.jpg classified as Anushka (confidence: 0.554)
✓ Attack Success: Alia Bhatt_8.jpg classified as Anushka (confidence: 0.580)
✓ Attack Success: Alia Bhatt_49.jpg classified as Anushka (confidence: 0.721)
✓ Attack Success: Alia Bhatt_55.jpg classified as Anushka (confidence: 0.828)

=== POISON FROG ATTACK RESULTS ===
Attack Success Rate: 92.31% (12/13 Alia images misclassified as Anushka)
Anushka Accuracy: 97.50% (39/40 Anushka images classified correctly)
Attack is SUCCESSFUL

=== ATTACK SUMMARY ===
Attack Success Rate: 92.31%
Base Class Accuracy: 97.50%
EXCELLENT! The poison frog attack is highly successful!
Poison training and testing completed successfully!

 Do you want to run another option? (y/n): y

==================================================
FACE CLASSIFICATION & POISON ATTACK MENU
==================================================
1. Train Clean Face Classification Model
2. Generate Poison Frog Attack Images
3. Train with Poison & Test Attack
4. Classify New Images (using clean model)
5. Classify New Images (using poisoned model)
6. Exit
==================================================

Enter your choice (1-6): 1

 Starting Clean Face Classification Training...
----------------------------------------
Starting Face Training v10.0.1...
Using device: cuda
Loading dataset...
Found 31 classes:
  0: Jessica Alba (108 images)
  1: Hugh Jackman (112 images)
  2: Lisa Kudrow (70 images)
  3: Margot Robbie (72 images)
  4: Kashyap (30 images)
  5: Priyanka Chopra (102 images)
  6: Natalie Portman (105 images)
  7: Marmik (32 images)
  8: Robert Downey Jr (113 images)
  9: Roger Federer (77 images)
  10: Tom Cruise (58 images)
  11: Vijay Deverakonda (115 images)
  12: Virat Kohli (49 images)
  13: Zac Efron (91 images)
  14: Camila Cabello (94 images)
  15: Brad Pitt (127 images)
  16: Billie Eilish (98 images)
  17: Charlize Theron (78 images)
  18: Claire Holt (106 images)
  19: Courtney Cox (99 images)
  20: Dwayne Johnson (61 images)
  21: Elizabeth Olsen (71 images)
  22: Ellen Degeneres (75 images)
  23: Henry Cavill (106 images)
  24: Hrithik Roshan (101 images)
  25: Akshay Kumar (50 images)
  26: Alexandra Daddario (92 images)
  27: Alia Bhatt (66 images)
  28: Amitabh Bachchan (74 images)
  29: Andy Samberg (92 images)
  30: Anushka Sharma (68 images)

Dataset split:
  Total images: 2592
  Training: 1814
  Validation: 388
  Test: 390

 All required classes found for poison attack!
   Anushka Sharma: Class 30
   Alia Bhatt: Class 27

Starting training...

Epoch 1/30

Training:   0%|          | 0/57 [00:02<?, ?it/s]

---------------------------------------------------------------------------

KeyboardInterrupt                         Traceback (most recent call last)

<ipython-input-50-d57b30e08c04> in <cell line: 0>()
    203 
    204 if __name__ == "__main__":
--> 205     main()

10 frames

/usr/lib/python3.11/threading.py in wait(self, timeout)
    329             else:
    330                 if timeout > 0:
--> 331                     gotit = waiter.acquire(True, timeout)
    332                 else:
    333                     gotit = waiter.acquire(False)

KeyboardInterrupt: 

